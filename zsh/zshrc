#!/usr/bin/zsh

# Z-Shell Config

# Path
PATH="$PATH:/home/fts427/.local/bin"
PATH="$PATH:/home/fts427/.dotnet/tools"
PATH="$PATH:/opt/android-sdk/platform-tools"

# History
HISTFILE=~/.histfile
HISTSIZE=4096
SAVEHIST=4096

# Beep
setopt beep
bindkey -e
zstyle :compinstall filename '$HOME/.zshrc'

# Repo
export REPO_URL='https://mirrors.tuna.tsinghua.edu.cn/git/git-repo'

# Plugins
source /usr/share/zsh/plugins/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
source /usr/share/zsh/plugins/zsh-autosuggestions/zsh-autosuggestions.zsh

# Alias
alias ls='lsd'
alias la='lsd -a'
alias ll='lsd -l'
alias vimrc='vim ~/.vimrc'
alias zshrc='vim ~/.zshrc'
alias reboot='doas systemctl reboot'
alias shutdown='doas systemctl poweroff'
alias untgz='tar -zxvf'
alias bat='bat --theme Nord'
alias tree='lsd --tree'
alias grep='grep --color'

# DE
if [ -z "$WAYLAND_DISPLAY" ] && [ -n "$XDG_VTNR" ] && [ "$XDG_VTNR" -eq 1 ] ; then
   exec Hyprland
fi

# Key Map
bindkey "\e[5~" beginning-of-history
bindkey "\e[6~" end-of-history
bindkey "\e[H" beginning-of-line
bindkey "\e[F" end-of-line
bindkey '^i' expand-or-complete-prefix

# Git prompt configuration
autoload -Uz vcs_info
autoload -Uz colors && colors

# Configure vcs_info
zstyle ':vcs_info:*' enable git
zstyle ':vcs_info:*' check-for-changes true
zstyle ':vcs_info:*' unstagedstr ' !'
zstyle ':vcs_info:*' stagedstr ' +'
zstyle ':vcs_info:git:*' formats '%F{yellow}[%b%u%c]%f'
zstyle ':vcs_info:git:*' actionformats '%F{yellow}[%b|%a%u%c]%f'

# Initialize prompt system
setopt prompt_subst
precmd() { 
    vcs_info
}

# Prompt
PROMPT=$'%B%F{cyan}[%n]%f@%F{blue}[%m]%F{green}[%1~]%f%b%F{white}$%f '
RPROMPT='${vcs_info_msg_0_}%F{white}[%*][%D]%f'

# Completion
autoload -U compinit
zstyle ':completion:*' menu select
zstyle ':completion:*' matcher-list 'm:{a-z}={A-Za-z}'
zstyle ':completion:*' cache-path "$HOME"/.zcompdump
zmodload zsh/complist
compinit -d "$HOME"/.zcompdump

# C Cache
export USE_CCACHE=1
export CCACHE_SLOPPINESS=file_macro,include_file_mtime,time_macros
export CCACHE_UMASK=002
export CCACHE_DIR=/var/tmp/ccache
#ccache -M 50G
#ccache -o compression=true

